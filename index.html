<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026 청소년부 교사 출석부</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans KR', sans-serif; }
    </style>
</head>
<body class="bg-slate-100 py-8 px-4">
    <div class="max-w-md mx-auto bg-white shadow-xl rounded-3xl overflow-hidden border border-gray-100">
        <div class="bg-indigo-700 p-8 text-white text-center">
            <h1 class="text-2xl font-bold tracking-tight">청소년부 교사 출석부</h1>
            <p class="text-indigo-100 text-sm mt-2 opacity-90">선생님, 오늘 사역 수고 많으셨습니다!</p>
        </div>
        
        <form id="attendanceForm" class="p-8 space-y-6">
            <div>
                <label class="block text-sm font-semibold text-gray-700 mb-2">교사 성함</label>
                <select name="teacherName" required class="w-full border border-gray-300 rounded-xl p-3 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition-all bg-gray-50">
                    <option value="">이름을 선택해 주세요</option>
                    <option value="도민수쌤(부장)">도민수쌤(부장)</option>
                    <option value="김영광쌤(총무)">김영광쌤(총무)</option>
                    <option value="허현범쌤(회계)">허현범쌤(회계)</option>
                    <option value="최은혜쌤(서기/중1 담임)">최은혜쌤(서기/중1 담임)</option>
                    <option value="박기태쌤(교육부장/보조교사)">박기태쌤(교육부장/보조교사)</option>
                    <option value="권오경쌤(고3-1 담임)">권오경쌤(고3-1 담임)</option>
                    <option value="윤동길쌤(고3-2 담임)">윤동길쌤(고3-2 담임)</option>
                    <option value="김혁배쌤(고2 담임)">김혁배쌤(고2 담임)</option>
                    <option value="백경호쌤(고1-1 담임)">백경호쌤(고1-1 담임)</option>
                    <option value="박대경쌤(고1-2 담임)">박대경쌤(고1-2 담임)</option>
                    <option value="김수연쌤(중3-1 담임)">김수연쌤(중3-1 담임)</option>
                    <option value="봉진영쌤(중3-2 담임)">봉진영쌤(중3-2 담임)</option>
                    <option value="유기주쌤(중2-1 담임)">유기주쌤(중2-1 담임)</option>
                    <option value="장근태쌤(중2-2 담임)">장근태쌤(중2-2 담임)</option>
                    <option value="정민지쌤(중1 부담임)">정민지쌤(중1 부담임)</option>
                    <option value="허예성쌤(중3-1 부담임)">허예성쌤(중3-1 부담임)</option>
                    <option value="박경민쌤(할룸/보조교사)">박경민쌤(할룸/보조교사)</option>
                </select>
            </div>

            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">부서예배</label>
                    <select name="deptWorship" class="w-full border border-gray-300 rounded-xl p-3 bg-gray-50">
                        <option value="참석">참석</option>
                        <option value="미참석">미참석</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">본당예배</label>
                    <select name="mainWorship" class="w-full border border-gray-300 rounded-xl p-3 bg-gray-50">
                        <option value="참석">참석</option>
                        <option value="미참석">미참석</option>
                    </select>
                </div>
            </div>

            <div>
                <label class="block text-sm font-semibold text-gray-700 mb-2">미출석 사유 (해당 시)</label>
                <input type="text" name="reason" placeholder="사유를 적어주세요" class="w-full border border-gray-300 rounded-xl p-3 bg-gray-50 outline-none focus:ring-2 focus:ring-indigo-500">
            </div>

            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">공과진행</label>
                    <select name="progress" class="w-full border border-gray-300 rounded-xl p-3 bg-gray-50">
                        <option value="진행">진행</option>
                        <option value="미진행">미진행</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">반 학생 출석</label>
                    <input type="number" name="studentCount" placeholder="0명" class="w-full border border-gray-300 rounded-xl p-3 bg-gray-50 outline-none focus:ring-2 focus:ring-indigo-500">
                </div>
            </div>

            <div>
                <label class="block text-sm font-semibold text-gray-700 mb-2">심방 및 특이사항</label>
                <textarea name="notes" rows="3" placeholder="기도제목이나 심방 내용을 기록해 주세요" class="w-full border border-gray-300 rounded-xl p-3 bg-gray-50 outline-none focus:ring-2 focus:ring-indigo-500"></textarea>
            </div>

            <button type="submit" id="submitBtn" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-4 rounded-xl shadow-lg transform active:scale-95 transition-all duration-150">
                출석 보고하기
            </button>
        </form>
    </div>

    <script>
        const scriptURL = 'https://script.google.com/macros/s/AKfycbyeJ6Gc-jZq-Ly7GHup3If74wCjoFF8szmN3uIKmx8i2ql9xjQ55iB4r7-tNji1CABI/exec';
        const form = document.getElementById('attendanceForm');
        const btn = document.getElementById('submitBtn');

        form.addEventListener('submit', e => {
            e.preventDefault();
            btn.disabled = true;
            btn.innerText = '전송 중...';
            btn.classList.replace('bg-indigo-600', 'bg-gray-400');

            const formData = new FormData(form);
            const data = Object.fromEntries(formData.entries());

            fetch(scriptURL, {
                method: 'POST',
                mode: 'no-cors', // CORS 정책 우회 (구글 웹앱용)
                cache: 'no-cache',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            })
            .then(() => {
                alert('정상적으로 제출되었습니다. 감사합니다!');
                form.reset();
            })
            .catch(error => {
                alert('오류가 발생했습니다. 다시 시도해 주세요.');
                console.error('Error!', error.message);
            })
            .finally(() => {
                btn.disabled = false;
                btn.innerText = '출석 보고하기';
                btn.classList.replace('bg-gray-400', 'bg-indigo-600');
            });
        });
    </script>
</body>
</html>
