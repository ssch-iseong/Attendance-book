<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026 ì²­ì†Œë…„ë¶€ êµì‚¬ ì¶œì„ë¶€</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * { font-family: 'Noto Sans KR', sans-serif; }
        body { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; }
        
        .form-card { 
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
            backdrop-filter: blur(10px);
        }

        .input-field {
            transition: all 0.3s ease;
        }

        .input-field:focus-within {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(102, 126, 234, 0.15);
        }

        .section-divider {
            height: 1px;
            background: linear-gradient(to right, transparent, #e5e7eb, transparent);
        }

        .attendance-toggle {
            display: flex;
            gap: 0.5rem;
        }

        .toggle-btn {
            flex: 1;
            padding: 0.75rem;
            border-radius: 0.75rem;
            border: 2px solid #e5e7eb;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
            color: #6b7280;
        }

        .toggle-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: transparent;
        }

        .submit-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            position: relative;
            overflow: hidden;
        }

        .submit-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 12px 24px rgba(102, 126, 234, 0.3);
        }

        .submit-btn:active:not(:disabled) {
            transform: translateY(0);
        }

        .icon-label {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 600;
            color: #374151;
        }

        .loading-spinner {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid #ffffff;
            border-radius: 50%;
            border-top-color: transparent;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .label-text {
            display: block;
            font-size: 0.875rem;
            font-weight: 600;
            color: #374151;
            margin-bottom: 0.5rem;
        }

        select, input, textarea {
            font-size: 1rem;
        }
    </style>
</head>
<body class="py-8 px-4">
    <div class="max-w-2xl mx-auto">
        <!-- Header -->
        <div class="text-center text-white mb-8">
            <h1 class="text-4xl font-bold mb-2">ì²­ì†Œë…„ë¶€ ì¶œì„ë¶€</h1>
            <p class="text-indigo-100 text-lg">ì„ ìƒë‹˜ì˜ ì‚¬ì—­ì„ ì‘ì›í•©ë‹ˆë‹¤ ğŸ™</p>
        </div>

        <!-- Main Form Card -->
        <div class="form-card bg-white rounded-2xl overflow-hidden">
            <form id="attendanceForm" class="p-8 space-y-8">
                <!-- êµì‚¬ ì •ë³´ ì„¹ì…˜ -->
                <div>
                    <label class="label-text">ğŸ‘¨â€ğŸ« êµì‚¬ ì„±í•¨</label>
                    <select name="teacherName" required class="w-full border-2 border-gray-200 rounded-xl p-3.5 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 outline-none transition-all bg-gray-50 hover:bg-white">
                        <option value="">ì´ë¦„ì„ ì„ íƒí•´ ì£¼ì„¸ìš”</option>
                        <option value="ë„ë¯¼ìˆ˜ìŒ¤(ë¶€ì¥)">ë„ë¯¼ìˆ˜ìŒ¤(ë¶€ì¥)</option>
                        <option value="ê¹€ì˜ê´‘ìŒ¤(ì´ë¬´)">ê¹€ì˜ê´‘ìŒ¤(ì´ë¬´)</option>
                        <option value="í—ˆí˜„ë²”ìŒ¤(íšŒê³„)">í—ˆí˜„ë²”ìŒ¤(íšŒê³„)</option>
                        <option value="ìµœì€í˜œìŒ¤(ì„œê¸°/ì¤‘1 ë‹´ì„)">ìµœì€í˜œìŒ¤(ì„œê¸°/ì¤‘1 ë‹´ì„)</option>
                        <option value="ë°•ê¸°íƒœìŒ¤(êµìœ¡ë¶€ì¥/ë³´ì¡°êµì‚¬)">ë°•ê¸°íƒœìŒ¤(êµìœ¡ë¶€ì¥/ë³´ì¡°êµì‚¬)</option>
                        <option value="ê¶Œì˜¤ê²½ìŒ¤(ê³ 3-1 ë‹´ì„)">ê¶Œì˜¤ê²½ìŒ¤(ê³ 3-1 ë‹´ì„)</option>
                        <option value="ìœ¤ë™ê¸¸ìŒ¤(ê³ 3-2 ë‹´ì„)">ìœ¤ë™ê¸¸ìŒ¤(ê³ 3-2 ë‹´ì„)</option>
                        <option value="ê¹€í˜ë°°ìŒ¤(ê³ 2 ë‹´ì„)">ê¹€í˜ë°°ìŒ¤(ê³ 2 ë‹´ì„)</option>
                        <option value="ë°±ê²½í˜¸ìŒ¤(ê³ 1-1 ë‹´ì„)">ë°±ê²½í˜¸ìŒ¤(ê³ 1-1 ë‹´ì„)</option>
                        <option value="ë°•ëŒ€ê²½ìŒ¤(ê³ 1-2 ë‹´ì„)">ë°•ëŒ€ê²½ìŒ¤(ê³ 1-2 ë‹´ì„)</option>
                        <option value="ê¹€ìˆ˜ì—°ìŒ¤(ì¤‘3-1 ë‹´ì„)">ê¹€ìˆ˜ì—°ìŒ¤(ì¤‘3-1 ë‹´ì„)</option>
                        <option value="ë´‰ì§„ì˜ìŒ¤(ì¤‘3-2 ë‹´ì„)">ë´‰ì§„ì˜ìŒ¤(ì¤‘3-2 ë‹´ì„)</option>
                        <option value="ìœ ê¸°ì£¼ìŒ¤(ì¤‘2-1 ë‹´ì„)">ìœ ê¸°ì£¼ìŒ¤(ì¤‘2-1 ë‹´ì„)</option>
                        <option value="ì¥ê·¼íƒœìŒ¤(ì¤‘2-2 ë‹´ì„)">ì¥ê·¼íƒœìŒ¤(ì¤‘2-2 ë‹´ì„)</option>
                        <option value="ì •ë¯¼ì§€ìŒ¤(ì¤‘1 ë¶€ë‹´ì„)">ì •ë¯¼ì§€ìŒ¤(ì¤‘1 ë¶€ë‹´ì„)</option>
                        <option value="í—ˆì˜ˆì„±ìŒ¤(ì¤‘3-1 ë¶€ë‹´ì„)">í—ˆì˜ˆì„±ìŒ¤(ì¤‘3-1 ë¶€ë‹´ì„)</option>
                        <option value="ë°•ê²½ë¯¼ìŒ¤(í• ë£¸/ë³´ì¡°êµì‚¬)">ë°•ê²½ë¯¼ìŒ¤(í• ë£¸/ë³´ì¡°êµì‚¬)</option>
                    </select>
                </div>

                <div class="section-divider"></div>

                <!-- ì˜ˆë°° ì°¸ì„ ì„¹ì…˜ -->
                <div>
                    <label class="label-text">ğŸ™ ì˜ˆë°° ì°¸ì„</label>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <p class="text-sm text-gray-600 mb-2">ë¶€ì„œì˜ˆë°°</p>
                            <div class="attendance-toggle" id="deptWorship">
                                <button type="button" class="toggle-btn active" data-value="ì°¸ì„">âœ“ ì°¸ì„</button>
                                <button type="button" class="toggle-btn" data-value="ë¯¸ì°¸ì„">âœ— ë¯¸ì°¸ì„</button>
                            </div>
                            <input type="hidden" name="deptWorship" value="ì°¸ì„">
                        </div>
                        <div>
                            <p class="text-sm text-gray-600 mb-2">ë³¸ë‹¹ì˜ˆë°°</p>
                            <div class="attendance-toggle" id="mainWorship">
                                <button type="button" class="toggle-btn active" data-value="ì°¸ì„">âœ“ ì°¸ì„</button>
                                <button type="button" class="toggle-btn" data-value="ë¯¸ì°¸ì„">âœ— ë¯¸ì°¸ì„</button>
                            </div>
                            <input type="hidden" name="mainWorship" value="ì°¸ì„">
                        </div>
                    </div>
                </div>

                <!-- ë¯¸ì¶œì„ ì‚¬ìœ  -->
                <div>
                    <label class="label-text">ğŸ“ ë¯¸ì¶œì„ ì‚¬ìœ  (í•´ë‹¹ ì‹œ)</label>
                    <input type="text" name="reason" placeholder="ì‚¬ìœ ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”" class="w-full border-2 border-gray-200 rounded-xl p-3.5 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 outline-none transition-all bg-gray-50">
                </div>

                <div class="section-divider"></div>

                <!-- ìˆ˜ì—… ì§„í–‰ ì„¹ì…˜ -->
                <div>
                    <label class="label-text">ğŸ“š ìˆ˜ì—… ì§„í–‰</label>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <p class="text-sm text-gray-600 mb-2">ê³µê³¼ ì§„í–‰</p>
                            <div class="attendance-toggle" id="progress">
                                <button type="button" class="toggle-btn active" data-value="ì§„í–‰">âœ“ ì§„í–‰</button>
                                <button type="button" class="toggle-btn" data-value="ë¯¸ì§„í–‰">âœ— ë¯¸ì§„í–‰</button>
                            </div>
                            <input type="hidden" name="progress" value="ì§„í–‰">
                        </div>
                        <div>
                            <label class="label-text text-sm">ğŸ‘¥ ë°˜ í•™ìƒ ì¶œì„</label>
                            <div class="flex items-center">
                                <input type="number" name="studentCount" placeholder="0" class="w-full border-2 border-gray-200 rounded-xl p-3.5 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 outline-none transition-all bg-gray-50">
                                <span class="ml-3 text-gray-500 font-medium">ëª…</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="section-divider"></div>

                <!-- íŠ¹ì´ì‚¬í•­ ì„¹ì…˜ -->
                <div>
                    <label class="label-text">ğŸ’¬ ì‹¬ë°© ë° íŠ¹ì´ì‚¬í•­</label>
                    <textarea name="notes" rows="4" placeholder="ê¸°ë„ì œëª©ì´ë‚˜ ì‹¬ë°© ë‚´ìš©ì„ ê¸°ë¡í•´ ì£¼ì„¸ìš”" class="w-full border-2 border-gray-200 rounded-xl p-3.5 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 outline-none transition-all bg-gray-50 resize-none"></textarea>
                </div>

                <!-- ì œì¶œ ë²„íŠ¼ -->
                <button type="submit" id="submitBtn" class="submit-btn w-full text-white font-bold py-4 rounded-xl shadow-lg transition-all duration-150 text-lg">
                    ì¶œì„ ë³´ê³ í•˜ê¸°
                </button>
            </form>
        </div>

        <!-- Footer -->
        <div class="text-center mt-6 text-indigo-100 text-sm">
            <p>ì–¸ì œë‚˜ ì‘ì›í•˜ê³  ìˆìŠµë‹ˆë‹¤</p>
        </div>
    </div>

    <script>
        const scriptURL = 'https://script.google.com/macros/s/AKfycbyzj9BEREOozqOJxNNgclfuLjnVJpLnDygeS098qpQVQR4OJ5SRd_kBc05YGYmnAeb8/exec';
        const form = document.getElementById('attendanceForm');
        const btn = document.getElementById('submitBtn');

        // í† ê¸€ ë²„íŠ¼ ê¸°ëŠ¥
        document.querySelectorAll('.attendance-toggle').forEach(toggle => {
            toggle.addEventListener('click', (e) => {
                if (e.target.classList.contains('toggle-btn')) {
                    const buttons = toggle.querySelectorAll('.toggle-btn');
                    buttons.forEach(btn => btn.classList.remove('active'));
                    e.target.classList.add('active');
                    
                    const hiddenInput = toggle.nextElementSibling;
                    hiddenInput.value = e.target.dataset.value;
                }
            });
        });

        form.addEventListener('submit', e => {
            e.preventDefault();
            btn.disabled = true;
            btn.innerHTML = '<span class="loading-spinner"></span> ì „ì†¡ ì¤‘...';

            const formData = new FormData(form);
            const data = Object.fromEntries(formData.entries());

            fetch(scriptURL, {
                method: 'POST',
                body: formData 
            })
            .then(() => {
                alert('âœ… ì •ìƒì ìœ¼ë¡œ ì œì¶œë˜ì—ˆìŠµë‹ˆë‹¤!\nê°ì‚¬í•©ë‹ˆë‹¤!');
                form.reset();
                document.querySelectorAll('.toggle-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                document.querySelectorAll('.toggle-btn:first-child').forEach(btn => {
                    btn.classList.add('active');
                });
            })
            .catch(error => {
                alert('âš ï¸ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\në‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.');
                console.error('Error!', error.message);
            })
            .finally(() => {
                btn.disabled = false;
                btn.innerHTML = 'ì¶œì„ ë³´ê³ í•˜ê¸°';
            });
        });

    </script>
</body>
</html>
